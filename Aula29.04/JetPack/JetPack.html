
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Salto com Espaço - WebGL</title>
  <style>
    body { margin: 0; }
    canvas { background: #eee; display: block; margin: auto; }
  </style>
</head>
<body>
<canvas id="canvas" width="500" height="500"></canvas>

<script>
const canvas = document.getElementById("canvas");
const gl = canvas.getContext("webgl");

// Shader de vértice com translação
const vertexShaderSource = `
  attribute vec2 coordinates;
  uniform vec2 translation;
  void main(void) {
    gl_Position = vec4(coordinates + translation, 0.0, 1.0);
  }
`;

// Shader de fragmento (preto)
const fragmentShaderSource = `
  void main(void) {
    gl_FragColor = vec4(0.1, 0.1, 0.1, 1.0);
  }
`;

// Compilação dos shaders
function createShader(type, source) {
  const shader = gl.createShader(type);
  gl.shaderSource(shader, source);
  gl.compileShader(shader);
  return shader;
}

const vertexShader = createShader(gl.VERTEX_SHADER, vertexShaderSource);
const fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentShaderSource);

// Criar programa
const shaderProgram = gl.createProgram();
gl.attachShader(shaderProgram, vertexShader);
gl.attachShader(shaderProgram, fragmentShader);
gl.linkProgram(shaderProgram);
gl.useProgram(shaderProgram);

// Coordenadas do quadrado (centro na origem)
const squareVertices = new Float32Array([
  -0.1, -0.1,
   0.1, -0.1,
   0.1,  0.1,
  -0.1,  0.1,
  -0.1, -0.1
]);

// Buffer
const squareBuffer = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, squareBuffer);
gl.bufferData(gl.ARRAY_BUFFER, squareVertices, gl.STATIC_DRAW);

const coord = gl.getAttribLocation(shaderProgram, "coordinates");
gl.vertexAttribPointer(coord, 2, gl.FLOAT, false, 0, 0);
gl.enableVertexAttribArray(coord);

const translationLocation = gl.getUniformLocation(shaderProgram, "translation");

let y = -0.8;
let velocity = 0;
let gravity = -0.001;
let jumping = false;

// Detecção da tecla espaço
document.addEventListener("keydown", (e) => {
  if (e.code === "Space") {
    velocity = 0.03; // força do salto
    jumping = true;
  }
});

// Função de animação
function animate() {
  gl.clearColor(1.0, 1.0, 1.0, 1.0);
  gl.clear(gl.COLOR_BUFFER_BIT);

  // Atualiza posição com gravidade
  if (jumping) {
    y += velocity;
    velocity += gravity;

    if (y <= -0.8) { // chão
      y = -0.8;
      velocity = 0;
      jumping = false;

    }
    if(y >= 0.8){ // teto
      y = 0.8;
      velocity = gravity;
      jumping = false;
    }
  }

  // Enviar translação e desenhar
  gl.uniform2fv(translationLocation, [0.0, y]);
  gl.drawArrays(gl.LINE_STRIP, 0, 5);

  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
